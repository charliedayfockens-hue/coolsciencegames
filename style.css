*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

:root {
    --bg1: #667eea;
    --bg2: #764ba2;
    --font: 'Segoe UI', sans-serif;
}

body {
    font-family: var(--font);
    background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
    background-attachment: fixed;
    min-height: 100vh;
    overflow-x: hidden;
    overflow-y: auto;
    transition: background 0.6s ease, font-family 0.3s ease;
}

/* ═══ BACKGROUND EFFECTS ═══ */
.matrix-canvas {
    position: fixed; top:0; left:0;
    width:100%; height:100%;
    pointer-events:none; z-index:0;
    opacity:0; transition: opacity 0.5s;
}
body.theme-matrix .matrix-canvas { opacity:1; }

.particles { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:0; overflow:hidden; }

/* ═══ MAIN MENU ═══ */
.main-menu {
    max-width: 1400px;
    margin: 0 auto;
    padding: 40px 20px 60px;
    position: relative; z-index:2;
    transition: opacity 0.4s ease, transform 0.4s ease;
}
.main-menu.hidden { opacity:0; transform:scale(0.96); pointer-events:none; }

/* ═══ HEADER ═══ */
header { text-align:center; margin-bottom:30px; }

.title {
    font-size: clamp(2rem, 5vw, 3.5rem);
    color: white;
    text-shadow: 0 4px 20px rgba(0,0,0,0.4);
    margin-bottom: 8px;
    font-family: inherit;
}
.subtitle { font-size:1.1rem; color:rgba(255,255,255,0.85); margin-bottom:12px; }

.stats-bar {
    display: flex; gap:20px; justify-content:center; flex-wrap:wrap;
    margin-bottom: 18px;
    font-size: 0.95rem; color: rgba(255,255,255,0.95); font-weight:600;
}
.stats-bar span {
    background: rgba(0,0,0,0.2);
    padding: 6px 14px;
    border-radius: 20px;
    backdrop-filter: blur(5px);
}

/* ═══ HEADER BUTTONS ═══ */
.header-buttons {
    display: flex; gap:10px; justify-content:center; flex-wrap:wrap;
    margin-top: 15px;
}

.hdr-btn {
    padding: 10px 20px;
    background: rgba(255,255,255,0.18);
    border: 2px solid rgba(255,255,255,0.45);
    border-radius: 25px;
    color: white;
    font-size: 0.95rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.25s ease;
    font-family: inherit;
}
.hdr-btn:hover { background:rgba(255,255,255,0.3); transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,0.2); }
.random-btn { background:rgba(255,200,0,0.25); border-color:rgba(255,200,0,0.7); }
.random-btn:hover { background:rgba(255,200,0,0.4); }
.eject-btn { background:rgba(255,60,0,0.25); border-color:rgba(255,100,0,0.7); }
.eject-btn:hover { background:rgba(255,60,0,0.4); }

/* ═══ DROPDOWNS ═══ */
.dropdown-wrap { position:relative; }

.hdr-dropdown {
    position: absolute; top:calc(100% + 8px); left:50%;
    transform: translateX(-50%);
    background: rgba(255,255,255,0.98);
    border-radius: 14px;
    box-shadow: 0 12px 40px rgba(0,0,0,0.3);
    min-width: 180px; max-height: 400px;
    overflow-y: auto;
    display: none; z-index: 10000;
    padding: 8px;
}
.hdr-dropdown.open { display:block; }

.theme-dd { min-width: 200px; }

.theme-btn, .cloak-item {
    display:block; width:100%;
    padding: 9px 14px;
    background: none; border:none;
    border-radius: 8px;
    text-align:left;
    font-size:0.9rem; font-weight:600; color:#333;
    cursor:pointer;
    transition: all 0.2s;
}
.theme-btn:hover, .cloak-item:hover { background:rgba(102,126,234,0.12); color:#667eea; }
.theme-btn.active, .cloak-item.active { background:rgba(102,126,234,0.2); color:#667eea; }

/* ═══ SEARCH ═══ */
.search-container { max-width:600px; margin:0 auto 30px; }
.search-bar {
    width:100%; padding:15px 22px;
    font-size:1rem; border:none; border-radius:50px;
    background:rgba(255,255,255,0.95);
    box-shadow:0 8px 32px rgba(0,0,0,0.2);
    font-family: inherit;
}

/* ═══ GAMES GRID ═══ */
.games-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 22px;
}

.game-button {
    padding: 28px 18px;
    background: rgba(255,255,255,0.92);
    border: none; border-radius: 18px;
    cursor: pointer;
    font-size: 1rem; font-weight: 700;
    color: #555;
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    transition: all 0.3s ease;
    font-family: inherit;
    position: relative;
    overflow: hidden;
}
.game-button::after {
    content:''; position:absolute; top:0; left:-100%;
    width:100%; height:100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
    transition: left 0.4s ease;
}
.game-button:hover { transform:translateY(-6px); box-shadow:0 18px 40px rgba(0,0,0,0.25); }
.game-button:hover::after { left:100%; }
.game-button.favorited { border:3px solid gold; }

.no-results { text-align:center; color:white; font-size:1.2rem; padding:40px; }

/* ═══ LEADERBOARD ═══ */
.leaderboard {
    position:fixed; top:20px; right:20px;
    background:rgba(255,255,255,0.96);
    backdrop-filter:blur(10px);
    border-radius:16px;
    box-shadow:0 10px 40px rgba(0,0,0,0.25);
    max-width:260px; z-index:1000;
    overflow:hidden;
}
.leaderboard-header {
    padding:14px 18px;
    font-weight:800; color:#667eea;
    cursor:pointer; user-select:none;
    display:flex; justify-content:space-between;
    background:rgba(102,126,234,0.08);
}
.leaderboard-body { max-height:0; overflow:hidden; transition:max-height 0.35s ease; }
.leaderboard-body.open { max-height:600px; }
.lb-item {
    display:flex; align-items:center; gap:8px;
    padding:8px 16px;
    border-bottom:1px solid rgba(0,0,0,0.05);
    font-size:0.85rem;
}
.lb-rank { font-weight:800; color:#667eea; min-width:24px; }
.lb-name { flex:1; color:#333; font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.lb-plays { color:#999; font-size:0.8rem; }
.lb-item:nth-child(1) .lb-rank { color:#ffd700; }
.lb-item:nth-child(2) .lb-rank { color:#c0c0c0; }
.lb-item:nth-child(3) .lb-rank { color:#cd7f32; }

/* ═══ GAME VIEWER ═══ */
.game-viewer {
    position:fixed; top:0; left:0; width:100%; height:100%;
    z-index:9000; display:flex; flex-direction:column;
    opacity:0; pointer-events:none;
    transform:scale(1.04);
    transition:opacity 0.35s ease, transform 0.35s ease;
}
.game-viewer.active { opacity:1; pointer-events:all; transform:scale(1); }

.game-toolbar {
    display:flex; align-items:center; justify-content:space-between;
    padding:0 16px;
    height:52px;
    background:rgba(0,0,0,0.85);
    backdrop-filter:blur(10px);
    border-bottom:2px solid rgba(255,255,255,0.1);
    flex-shrink:0;
    z-index:2;
}
.viewer-title {
    font-weight:800; color:white;
    font-size:1.1rem; max-width:200px;
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.toolbar-right { display:flex; align-items:center; gap:12px; }
.tool-group { display:flex; align-items:center; gap:6px; color:rgba(255,255,255,0.8); font-size:0.85rem; }
.tool-label { color:rgba(255,255,255,0.7); font-size:0.85rem; }
.tool-select {
    background:rgba(255,255,255,0.12); border:1px solid rgba(255,255,255,0.2);
    color:white; padding:4px 8px; border-radius:6px; font-size:0.85rem; cursor:pointer;
}
.volume-slider { width:70px; cursor:pointer; accent-color:#667eea; }
#volumeVal { color:rgba(255,255,255,0.7); font-size:0.8rem; min-width:34px; }
.tool-btn {
    padding:6px 12px;
    background:rgba(255,255,255,0.12);
    border:1px solid rgba(255,255,255,0.2);
    border-radius:8px; color:white;
    font-size:0.85rem; cursor:pointer;
    transition:all 0.2s;
}
.tool-btn:hover { background:rgba(255,255,255,0.22); }
.exit-btn { background:rgba(220,50,50,0.3); border-color:rgba(255,80,80,0.5); }
.exit-btn:hover { background:rgba(220,50,50,0.6); }

.game-frame-wrap { flex:1; position:relative; overflow:hidden; }
.game-frame {
    width:100%; height:100%;
    border:none; display:block;
    background:#000;
}

/* Minimized state */
.game-viewer.minimized {
    height:52px; top:auto;
    bottom:0; border-radius:0;
    transform:none; opacity:1; pointer-events:all;
    box-shadow:0 -4px 30px rgba(0,0,0,0.4);
}
.game-viewer.minimized .game-frame-wrap { display:none; }

/* ═══ THEMES ═══ */

/* Default - purple gradient, floating orbs */
body.theme-default {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    background-attachment: fixed;
}

/* Rainbow */
body.theme-rainbow {
    background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #8b00ff);
    background-size: 300% 300%;
    animation: rainbowCycle 6s linear infinite;
    font-family: 'Rubik', sans-serif !important;
}
@keyframes rainbowCycle {
    0%   { background-position: 0% 50%; }
    25%  { background-position: 100% 0%; }
    50%  { background-position: 100% 100%; }
    75%  { background-position: 0% 100%; }
    100% { background-position: 0% 50%; }
}

/* Galaxy */
body.theme-galaxy {
    background: radial-gradient(ellipse at 20% 50%, #1b2735 0%, #090a0f 100%);
    background-attachment: fixed;
    font-family: 'Orbitron', sans-serif !important;
}

/* Dark Mode */
body.theme-dark-mode {
    background: #0a0a0a;
    background-attachment: fixed;
    font-family: 'Inter', sans-serif !important;
}

/* Neon Cyberpunk */
body.theme-neon-cyberpunk {
    background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 50%, #0a1628 100%);
    background-attachment: fixed;
    font-family: 'Audiowide', cursive !important;
}

/* Retro Arcade */
body.theme-retro-arcade {
    background: #1a1a2e;
    background-attachment: fixed;
    font-family: 'Press Start 2P', cursive !important;
}

/* Forest Fantasy */
body.theme-forest-fantasy {
    background: linear-gradient(180deg, #1a4a1a 0%, #2d5a1b 50%, #1a3d1a 100%);
    background-attachment: fixed;
    font-family: 'Cinzel', serif !important;
}

/* Fire & Lava */
body.theme-fire-lava {
    background: linear-gradient(180deg, #ff4500 0%, #ff1a00 50%, #cc0000 100%);
    background-size: 200% 200%;
    animation: firePulse 4s ease-in-out infinite;
    font-family: 'Russo One', sans-serif !important;
}
@keyframes firePulse {
    0%, 100% { background-position: 0% 0%; }
    50% { background-position: 100% 100%; }
}

/* Ice Kingdom */
body.theme-ice-kingdom {
    background: linear-gradient(135deg, #00b4db 0%, #0083b0 100%);
    background-attachment: fixed;
    font-family: 'Rajdhani', sans-serif !important;
}

/* Ocean Depths */
body.theme-ocean-depths {
    background: linear-gradient(180deg, #003973 0%, #001f3f 100%);
    background-attachment: fixed;
    font-family: 'Exo 2', sans-serif !important;
}

/* Desert Storm */
body.theme-desert-storm {
    background: linear-gradient(135deg, #d4a056 0%, #c17f24 50%, #a0522d 100%);
    background-attachment: fixed;
    font-family: 'Teko', sans-serif !important;
}

/* Glitch Mode */
body.theme-glitch-mode {
    background: #050505;
    background-attachment: fixed;
    font-family: 'VT323', monospace !important;
    animation: glitchBg 0.4s infinite;
}
@keyframes glitchBg {
    0%   { filter: none; }
    92%  { filter: none; }
    93%  { filter: hue-rotate(90deg) saturate(5); }
    94%  { filter: none; }
    96%  { filter: hue-rotate(180deg); }
    97%  { filter: none; }
    100% { filter: none; }
}
body.theme-glitch-mode .game-button { animation: btnShake 0.5s infinite; }
@keyframes btnShake {
    0%,100% { transform: translate(0,0); }
    20%  { transform: translate(-2px, 2px); }
    40%  { transform: translate(2px, -1px); }
    60%  { transform: translate(-1px, 2px); }
    80%  { transform: translate(2px, -2px); }
}

/* Synthwave */
body.theme-synthwave {
    background: linear-gradient(180deg, #2d1b69 0%, #11998e 100%);
    background-attachment: fixed;
    font-family: 'Bungee', cursive !important;
}

/* Blood Moon */
body.theme-blood-moon {
    background: radial-gradient(ellipse at top right, #4d0000 0%, #1a0000 100%);
    background-attachment: fixed;
    font-family: 'Creepster', cursive !important;
    animation: bloodPulse 5s ease-in-out infinite;
}
@keyframes bloodPulse {
    0%,100% { filter: brightness(1); }
    50% { filter: brightness(1.15); }
}

/* Minimal White */
body.theme-minimal-white {
    background: #f8f9fa;
    background-attachment: fixed;
    font-family: 'Montserrat', sans-serif !important;
}
body.theme-minimal-white .title,
body.theme-minimal-white .subtitle { color: #333 !important; }
body.theme-minimal-white .stats-bar { color: #555 !important; }
body.theme-minimal-white .hdr-btn { color: #333; border-color:rgba(0,0,0,0.3); background:rgba(0,0,0,0.08); }

/* Matrix */
body.theme-matrix {
    background: #000;
    background-attachment: fixed;
    font-family: 'Share Tech Mono', monospace !important;
}
body.theme-matrix .game-button { background:rgba(0,0,0,0.9); color:#00ff00; border:1px solid #00ff00; box-shadow:0 0 10px rgba(0,255,0,0.2); }
body.theme-matrix .title { color:#00ff00; text-shadow:0 0 20px #00ff00; }

/* Galaxy Rainbow */
body.theme-galaxy-rainbow {
    background: linear-gradient(45deg, #ff0080, #ff8c00, #40e0d0, #9400d3);
    background-size: 300% 300%;
    animation: galaxyRainbow 8s ease infinite;
    font-family: 'Oxanium', cursive !important;
}
@keyframes galaxyRainbow {
    0%   { background-position: 0% 50%; }
    33%  { background-position: 100% 0%; }
    66%  { background-position: 50% 100%; }
    100% { background-position: 0% 50%; }
}

/* Steampunk */
body.theme-steampunk {
    background: linear-gradient(135deg, #3e2723 0%, #5d4037 100%);
    background-attachment: fixed;
    font-family: 'MedievalSharp', cursive !important;
}
body.theme-steampunk .game-button { background:rgba(205,127,50,0.4); color:#ffd700; border:2px solid #b8860b; }

/* Cartoon Pop */
body.theme-cartoon-pop {
    background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 50%, #ffe66d 100%);
    background-size: 200% 200%;
    animation: cartoonPop 7s ease infinite;
    font-family: 'Luckiest Guy', cursive !important;
}
@keyframes cartoonPop {
    0%,100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

/* Shadow Realm */
body.theme-shadow-realm {
    background: linear-gradient(135deg, #1a0033 0%, #2d004d 50%, #0d001a 100%);
    background-attachment: fixed;
    font-family: 'Chakra Petch', sans-serif !important;
}
body.theme-shadow-realm .game-button { background:rgba(75,0,130,0.4); color:#da70d6; border:1px solid #9370db; }

/* Snowy Night */
body.theme-snowy-night {
    background: linear-gradient(180deg, #1a3a5c 0%, #2c5f8a 50%, #1a3a5c 100%);
    background-attachment: fixed;
    font-family: 'Silkscreen', cursive !important;
}

/* Custom */
body.theme-custom {
    background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%) !important;
    font-family: var(--font) !important;
}

/* Universal font inheritance */
body[class*="theme-"] .game-button,
body[class*="theme-"] .hdr-btn,
body[class*="theme-"] .search-bar,
body[class*="theme-"] .title,
body[class*="theme-"] .subtitle {
    font-family: inherit;
}

/* ═══ PARTICLE EFFECTS ═══ */
/* Shooting stars for Galaxy */
.star-particle {
    position:absolute;
    width:3px; height:3px;
    background:white;
    border-radius:50%;
    animation: shootStar linear infinite;
}
@keyframes shootStar {
    0% { transform:translateX(0) translateY(0) scaleX(1); opacity:1; }
    100% { transform:translateX(calc(var(--dx)*100px)) translateY(calc(var(--dy)*100px)) scaleX(8); opacity:0; }
}

/* Snow for Ice/Snowy */
.snow-particle {
    position:absolute;
    color:white; font-size:1.2rem;
    animation: snowFall linear infinite;
    opacity: 0.7;
}
@keyframes snowFall {
    0% { transform:translateY(-20px) rotate(0deg); opacity:0.8; }
    100% { transform:translateY(105vh) rotate(360deg); opacity:0; }
}

/* Leaf for forest */
.leaf-particle {
    position:absolute;
    font-size:1.5rem;
    animation: leafFall ease-in-out infinite;
    opacity:0.6;
}
@keyframes leafFall {
    0% { transform:translateY(-30px) rotate(0deg) translateX(0); opacity:0.7; }
    50% { transform:translateY(50vh) rotate(180deg) translateX(40px); }
    100% { transform:translateY(105vh) rotate(360deg) translateX(-20px); opacity:0; }
}

/* Fire sparks */
.fire-particle {
    position:absolute;
    font-size:1.8rem;
    animation: fireRise ease-in infinite;
    opacity:0.6;
}
@keyframes fireRise {
    0% { transform:translateY(0) scale(1) rotate(0deg); opacity:0.7; }
    100% { transform:translateY(-100vh) scale(0) rotate(30deg); opacity:0; }
}

/* Gear for steampunk */
.gear-particle {
    position:absolute;
    font-size:4rem;
    opacity:0.1;
    animation:gearTurn linear infinite;
}
@keyframes gearTurn {
    from { transform:rotate(0deg); }
    to { transform:rotate(360deg); }
}

/* ═══ RECENT DROPDOWN ITEMS ═══ */
.recent-item {
    display:flex; align-items:center; gap:10px;
    padding:8px 14px;
    cursor:pointer; border-radius:8px;
    font-size:0.9rem; color:#333; font-weight:600;
    transition:background 0.2s;
}
.recent-item:hover { background:rgba(102,126,234,0.12); }
.recent-item span { font-size:1.2rem; }

/* ═══ RESPONSIVE ═══ */
@media(max-width:768px) {
    .leaderboard { right:10px; top:10px; max-width:200px; }
    .games-grid { grid-template-columns:repeat(auto-fill,minmax(150px,1fr)); }
    .game-viewer.minimized { height:48px; }
    .toolbar-right { gap:6px; }
    .tool-group label:first-child { display:none; }
}
